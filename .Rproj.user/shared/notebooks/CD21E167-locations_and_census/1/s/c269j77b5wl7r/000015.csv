"0","locations <- read_xlsx(""./data/ken_adminboundaries_tabulardata_v2.xlsx"", "
"0","                       sheet = ""ADM2"") %>% "
"0","  clean_names() %>%"
"0","  mutate(adm2alt1_en = ifelse(adm2_pcode == ""KE033177"", ""Transmara East"", adm2alt1_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE033177"", ""Transmara West"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE002010"", ""Samburu"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE007027"", ""Garissa Township"", adm2alt1_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE010048"", ""Loyangalani"", adm2alt2_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE010046"", ""Chalbi"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE039220"", ""Bungoma South"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE039224"", ""Bungoma North"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE039224"", ""Bungoma North"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE007031"", ""Hulugho"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE003012"", ""Chonyi"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE003015"", ""Kauma"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE006024"", ""Taita"", adm2alt1_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE008033"", ""Buna"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE009042"", ""Kutulo"", adm2alt1_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE009042"", ""Mandera Central"", adm2alt2_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE010046"", ""Marsabit North"", adm2alt2_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE011049"", ""Isiolo"", adm2alt2_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE012056"", ""Imenti North"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE012059"", ""Imenti South"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE012058"", ""Meru Central"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE012057"", ""Buuri East"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE012057"", ""Buuri West"", adm2alt2_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE012055"", ""Tigania Central"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE023123"", ""Kibish"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE019099"", ""Nyeri Central"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE019098"", ""Mukurwe-ini"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE019095"", ""Kieni East"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE019095"", ""Kieni West"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE019096"", ""Mathira East"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE019096"", ""Mathira West"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE020101"", ""Kirinyaga East"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE020102"", ""Kirinyaga West"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE020100"", ""Mwea East"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE020100"", ""Mwea West"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE013060"", ""Nithi"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE013062"", ""Tharaka North"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE013062"", ""Tharaka South"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE014065"", ""Mbeere South"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE014066"", ""Mbeere North"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE014066"", ""Mbeere North"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE015074"", ""Ikutha"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE015074"", ""Katulani"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE015071"", ""Kisasi"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE015067"", ""Kyuso"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE015067"", ""Kyuso"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE015067"", ""Migwani"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE016080"", ""Athi River"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE016081"", ""Kalama"", adm2alt1_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE016081"", ""Machakos"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE017086"", ""Kathonzweni"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE017083"", ""Mbooni East"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE017083"", ""Mbooni West"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE017085"", ""Kilungu"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE017087"", ""Makindu"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE017084"", ""Mukaa"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE017086"", ""Nzaui"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE024131"", ""Pokot North"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE025133"", ""Samburu Central"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE026140"", ""Trans Nzoia East"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE026137"", ""Trans Nzoia West"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE030157"", ""East Pokot"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE030157"", ""Tiaty East"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE030162"", ""Koibatek"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE030162"", ""Koibatek"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE033178"", ""Transmara East"", adm2alt1_en),"
"0","         # Only because Kilgoris was formerly in the former Transmara District"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE033177"", ""Transmara West"", adm2alt1_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE033177"", NA_character_, adm2alt2_en), "
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE013061"", ""Igambang'ombe"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE013060"", ""Meru South"", adm2alt2_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE017086"", ""Kathonzweni"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE017088"", ""Kibwezi"", adm2alt1_en),"
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE034187"", ""Loitokitok"", adm2alt2_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE034186"", ""Mashuuru"", adm2alt2_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE039218"", ""Bungoma Central"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE039221"", ""Bungoma East"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE039223"", ""Kimilili-Bungoma"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE047280"", ""Njiru"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE047277"", ""Lang'ata"", adm2alt1_en), "
"0","         adm2alt2_en = ifelse(adm2_pcode == ""KE024131"", ""North Pokot"", adm2alt2_en), "
"0","         adm2alt1_en = ifelse(adm2_en == ""Baringo South"", ""Marigat"", adm2alt1_en), "
"0","         adm2alt1_en = ifelse(adm2_en == ""Baringo Central"", NA_character_, adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE024130"", ""Pokot Central"", adm2alt1_en),"
"0","         adm2alt1_en = ifelse(adm2_pcode == ""KE024129"", NA_character_, adm2alt1_en)) %>% "
"0","  mutate(adm2alt1_en = ifelse(adm2_pcode == ""KE008036"", NA_character_, adm2alt1_en)) %>% "
"0","  filter(!is.na(adm2_pcode))"
"0",""
"0",""
"0","pcode2_shape <- "
"0","  sf::st_read(""./data/ken_adm_iebc_20191031_shp/ken_admbnda_adm2_iebc_20191031.shp"", "
"0","          quiet = TRUE) %>% "
"0","  clean_names() %>% "
"0","  st_as_sf() %>%"
"0","  mutate(fo = case_when(adm1_en %in% c(""Samburu"", ""Turkana"", ""West Pokot"", ""Baringo"") ~ ""Lodwar"", "
"0","                        adm1_en %in% c(""Garissa"", ""Isiolo"", ""Mandera"", ""Marsabit"", ""Tana River"", ""Wajir"") ~ ""Garissa"", "
"0","                        adm1_en %in% c(""Bungoma"", ""Narok"") ~ ""Kisumu"", "
"0","                        adm1_en %in% c(""Nairobi"", ""Kilifi"", ""Kwale"", ""Kajiado"") ~ ""Nairobi""))"
"0",""
"0",""
"0","pcode1_shape <- "
"0","  sf::st_read(""./data/ken_adm_iebc_20191031_shp/ken_admbnda_adm1_iebc_20191031.shp"", "
"0","          quiet = TRUE) %>% "
"0","  clean_names()"
"0",""
"0","adm2 <- read_csv(""./data/partner_admin2.csv"") %>% "
"0","  mutate(sub_county = trimws(sub_county), "
"0","         county = trimws(county)) %>% "
"0","  mutate(sub_county = str_replace_all(sub_county, ""Lungalunga"", ""Lunga Lunga""),"
"0","         sub_county = str_replace_all(sub_county, ""Kauma"", ""Ganze""), "
"0","         sub_county = str_replace_all(sub_county, ""Garissa town"", ""Garissa Township""), "
"0","         sub_county = ifelse(sub_county == ""Garissa"", ""Garissa Township"", sub_county), "
"0","         sub_county = str_replace_all(sub_county, ""Kamkunji"", ""Kamukunji""), "
"0","         sub_county = str_replace_all(sub_county, ""Garbatula"", ""Garbatulla""),"
"0","         sub_county = str_replace_all(sub_county, ""Pokot North"", ""North Pokot""),"
"0","         sub_county = str_replace_all(sub_county, ""Hulogho"", ""Hulugho""), "
"0","         sub_county = str_replace_all(sub_county, ""Cenral"", ""Central""), "
"0","         sub_county = ifelse(sub_county == ""Tiaty East"" & county == ""Baringo"", "
"0","                             ""Tiaty"", "
"0","                             sub_county),"
"0","         sub_county = ifelse(sub_county == ""Bungoma West (sirisia)"" & county == ""Bungoma"", "
"0","                             ""Sirisia"", "
"0","                             sub_county), "
"0","         sub_county = ifelse(str_detect(sub_county, ""Dagoreti"") & county == ""Nairobi"", "
"0","                             ""Dagoretti"", "
"0","                             sub_county), "
"0","         sub_county = ifelse(sub_county == ""Central"" & county == ""Samburu"", "
"0","                             ""Samburu Central"","
"0","                             sub_county)) %>% "
"0","  filter(sub_county %out% c(""Chonyi"", ""Isiolo"")) %>% "
"0","  left_join(locations %>%"
"0","              distinct(adm1_en, adm1_pcode), "
"0","            by = c(""county"" = ""adm1_en"")) %>%"
"0","  left_join(locations %>%"
"0","              select(adm2_en, adm2_pcode_a = adm2_pcode, adm1_en), "
"0","            by = c(""sub_county"" = ""adm2_en"", "
"0","                   ""county"" = ""adm1_en"")) %>% "
"0","  left_join(locations %>%"
"0","              select(adm2alt1_en, adm2_pcode_b = adm2_pcode, adm1_en), "
"0","            by = c(""sub_county"" = ""adm2alt1_en"", "
"0","                   ""county"" = ""adm1_en"")) %>% "
"0","  left_join(locations %>%"
"0","              select(adm2alt2_en, adm2_pcode_c = adm2_pcode, adm1_en), "
"0","            by = c(""sub_county"" = ""adm2alt2_en"", "
"0","                   ""county"" = ""adm1_en"")) %>% "
"0","  mutate(adm2_pcode = coalesce(adm2_pcode_a, adm2_pcode_b, adm2_pcode_c)) %>% "
"0","  mutate(# Persistent problem"
"0","         adm2_pcode = ifelse(sub_county == ""Transmara West"", "
"0","                             ""KE033177"", "
"0","                             adm2_pcode), "
"0","         adm2_pcode = ifelse(sub_county == ""Transmara East"", "
"0","                             ""KE033177"", "
"0","                             adm2_pcode)) %>% "
"0","  select(-adm2_pcode_a, -adm2_pcode_b, -adm2_pcode_c) %>% "
"0","  left_join(locations %>% select(adm2_en, adm2_pcode), "
"0","            by = ""adm2_pcode"") %>% "
"0","  mutate(constituency = ifelse(!is.na(adm2_pcode), "
"0","                             adm2_en, "
"0","                             sub_county)) %>% "
"0","  select(-adm2_en) %>% "
"0","  # Pull out this list to send back to UNICEF for verification"
"0","  # filter(is.na(adm2_pcode))"
"0","  distinct(county, constituency, partner, adm1_pcode, adm2_pcode) %>% "
"0","  mutate(partner = trimws(partner), "
"0","         partner = ifelse(partner == ""Life Skills Promoters (LISP)"", ""LISP"", partner)) %>% "
"0","  mutate(fo = case_when(county %in% c(""Samburu"", ""Turkana"", ""West Pokot"", ""Baringo"") ~ ""Lodwar"", "
"0","                        county %in% c(""Garissa"", ""Isiolo"", ""Mandera"", ""Marsabit"", ""Tana River"", ""Wajir"") ~ ""Garissa"", "
"0","                        county %in% c(""Bungoma"", ""Narok"") ~ ""Kisumu"", "
"0","                        county %in% c(""Nairobi"", ""Kilifi"", ""Kwale"", ""Kajiado"") ~ ""Nairobi"")) %>% "
"0","  mutate(partner = ifelse(partner == ""Fin Church Aid (FCA)"", ""Finn Church Aid"", partner), "
"0","         adm2_pcode = ifelse(constituency == ""Kipkomo"", ""KE024129"", adm2_pcode), "
"0","         constituency = ifelse(adm2_pcode == ""KE024129"", ""Kapenguira"", constituency"
"0","                               )) %>% "
"0","  filter(!is.na(constituency))"
"2","[1mRows: [22m[34m147[39m [1mColumns: [22m[34m3[39m"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (3): county, sub_county, partner"
"2","
[36mi[39m Use `spec()` to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","  "
"0","adm1 <- adm2 %>% "
"0","  distinct(county, partner, adm1_pcode, fo)  "
"0",""
"0","all_towns_shape <- "
"0","  sf::st_read(""./data/kenya_all_towns/kenya_all_towns_eeTVhKM.shp"", "
"0","          quiet = TRUE) %>% "
"0","  clean_names() %>% "
"0","  st_as_sf() %>%"
"0","           filter(town_type %in% c(""City"", ""Municipality"", ""Township/Town"", ""Trading Centre""))"
"0",""
"0","census_sub_counties <- V4_T1.9 %>% "
"0","  clean_names() %>% "
"0","  mutate(sub_county_pcode = paste0(""KEN_"", county_code, ""_"", sub_county_code)) %>% "
"0","  mutate_at(vars(county, sub_county),"
"0","              ~ str_to_title(.)) %>%"
"0","    mutate(county = str_replace_all(county, ""/"", ""-""), "
"0","           county = str_replace_all(county, ""Taita-Taveta"", ""Taita Taveta""), "
"0","           county = str_replace_all(county, ""\\sCity"", """")) %>% "
"0","    mutate(sub_county ="
"0","             str_replace_all(sub_county,"
"0","                             c(""Lunga Lunga"" = ""Lungalunga"","
"0","                               ""Mukurwe-Ini"" = ""Mukurwe-ini"", "
"0","                               ""Kimilili"" = ""Kimilili-Bungoma"", "
"0","                               ""Kotulo"" = ""Kutulo"","
"0","                               ""Mt Elgon Forest"" = ""Mt Elgon"")), "
"0","           sub_county = ifelse(county == ""Kwale"" & sub_county == ""Samburu"", "
"0","                               ""Samburu-Kwale"", "
"0","                               sub_county)) "
"0",""
"0","poverty <- read_csv(""./data/poverty_chart.csv"") %>% "
"0","  `colnames<-`(c(""county"", ""poverty_incidence"", ""distribution_of_poor"", "
"0","                 ""poverty_gap"", ""severity_of_poverty"", ""population"", ""number_of_poor"")) %>% "
"0","  mutate(county = str_replace_all(county, ""Taita/Taveta"", ""Taita Taveta""), "
"0","         county = str_replace_all(county, ""Elgeyo/Marakwet"", ""Elgeyo-Marakwet""), "
"0","         county = str_replace_all(county, ""Nairobi City"", ""Nairobi"")) %>% "
"0","  left_join(locations %>% "
"0","              distinct(adm1_en, adm1_pcode), "
"0","            by = c(""county"" = ""adm1_en"")) "
"2","[1mRows: [22m[34m50[39m [1mColumns: [22m[34m7[39m"
"2","[36m--[39m [1mColumn specification[22m [36m---------------------------------------------------------------------------------[39m
[1mDelimiter:[22m "",""
[31mchr[39m (1): Residence / County
[32mdbl[39m (4): Headcount Rate (%), Distribution of the Poor (%), Poverty Gap (%), Severity of Poverty (%)"
"2","
[36mi[39m Use `spec()` to retrieve the full column specification for this data.
[36mi[39m Specify the column types or set `show_col_types = FALSE` to quiet this message."
"0","  "
